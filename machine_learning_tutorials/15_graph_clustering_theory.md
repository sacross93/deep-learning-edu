# 그래프 기반 클러스터링 이론

## 1. 그래프 기반 클러스터링 개요

### 1.1 그래프 클러스터링이란?
**그래프 기반 클러스터링**은 데이터를 그래프로 표현하고, 그래프의 구조적 특성을 이용하여 클러스터를 탐지하는 방법입니다. 주로 네트워크 데이터에서 커뮤니티(community)를 찾는 데 사용됩니다.

### 1.2 핵심 아이디어
- **그래프 표현**: 데이터를 노드(vertex)와 엣지(edge)로 구성된 그래프로 모델링
- **커뮤니티**: 내부 연결은 밀집되고 외부 연결은 희소한 노드 그룹
- **구조적 분석**: 그래프의 토폴로지 정보를 활용한 클러스터링

### 1.3 주요 특징
- 네트워크 구조 정보 활용
- 비유클리드 공간에서의 클러스터링
- 소셜 네트워크, 생물학적 네트워크 등에 적합
- 계층적 구조 탐지 가능

## 2. 그래프 이론 기초

### 2.1 기본 개념
```
그래프 G = (V, E)
- V: 노드(정점) 집합
- E: 엣지(간선) 집합
- 가중치: w(u,v) - 노드 u와 v 사이의 연결 강도
```

### 2.2 그래프 유형
1. **무방향 그래프**: 엣지에 방향이 없음
2. **방향 그래프**: 엣지에 방향이 있음
3. **가중 그래프**: 엣지에 가중치가 있음
4. **단순 그래프**: 자기 루프와 중복 엣지가 없음

### 2.3 그래프 표현
```python
# 인접 행렬 (Adjacency Matrix)
A[i][j] = 1 if (i,j) ∈ E, 0 otherwise

# 인접 리스트 (Adjacency List)
adj[i] = [j for all j where (i,j) ∈ E]

# 엣지 리스트 (Edge List)
edges = [(i,j,w) for all edges with weight w]
```

## 3. 커뮤니티 탐지 알고리즘

### 3.1 Girvan-Newman 알고리즘
**분할적(Divisive) 접근법**으로 엣지 중심성이 높은 엣지를 제거하여 커뮤니티를 분리합니다.

#### 알고리즘 단계:
```python
def girvan_newman(G):
    1. 모든 엣지의 중심성(betweenness centrality) 계산
    2. 가장 높은 중심성을 가진 엣지 제거
    3. 그래프가 분리되는지 확인
    4. 분리될 때까지 1-3 반복
    5. 각 연결 성분이 하나의 커뮤니티
```

#### 엣지 중심성:
- 모든 최단 경로 중 해당 엣지를 지나는 경로의 비율
- 커뮤니티 간 다리 역할을 하는 엣지는 높은 중심성을 가짐

### 3.2 Louvain 알고리즘
**모듈성(Modularity) 최적화**를 통한 효율적인 커뮤니티 탐지 알고리즘입니다.

#### 알고리즘 단계:
```python
def louvain_algorithm(G):
    1. 각 노드를 별도의 커뮤니티로 초기화
    2. 각 노드에 대해:
       - 이웃 커뮤니티로 이동 시 모듈성 변화 계산
       - 모듈성이 증가하는 최적 커뮤니티로 이동
    3. 모듈성 개선이 없을 때까지 2 반복
    4. 커뮤니티를 슈퍼노드로 압축하여 새 그래프 생성
    5. 새 그래프에서 1-4 반복
```

### 3.3 Label Propagation
**레이블 전파**를 통한 빠른 커뮤니티 탐지 방법입니다.

#### 알고리즘 단계:
```python
def label_propagation(G):
    1. 각 노드에 고유한 레이블 할당
    2. 각 노드에 대해:
       - 이웃 노드들의 레이블 중 가장 빈번한 레이블 선택
       - 자신의 레이블을 선택된 레이블로 업데이트
    3. 수렴할 때까지 2 반복
    4. 같은 레이블을 가진 노드들이 하나의 커뮤니티
```

## 4. 모듈성 (Modularity)

### 4.1 모듈성 정의
모듈성은 커뮤니티 구조의 품질을 측정하는 지표입니다.

```
Q = (1/2m) Σ[A_ij - (k_i × k_j)/(2m)] × δ(c_i, c_j)

여기서:
- m: 전체 엣지 수
- A_ij: 인접 행렬 원소
- k_i: 노드 i의 차수(degree)
- c_i: 노드 i가 속한 커뮤니티
- δ(c_i, c_j): 같은 커뮤니티면 1, 아니면 0
```

### 4.2 모듈성 해석
- **Q > 0.3**: 유의미한 커뮤니티 구조
- **Q > 0.7**: 강한 커뮤니티 구조
- **Q ≈ 0**: 랜덤 네트워크와 유사
- **Q < 0**: 커뮤니티 구조가 랜덤보다 약함

### 4.3 모듈성의 한계
- **해상도 한계**: 작은 커뮤니티를 탐지하지 못할 수 있음
- **지역 최적해**: 전역 최적해를 보장하지 않음
- **크기 편향**: 큰 커뮤니티를 선호하는 경향

## 5. 스펙트럴 클러스터링

### 5.1 기본 개념
그래프의 **라플라시안 행렬(Laplacian Matrix)**의 고유벡터를 이용한 클러스터링 방법입니다.

### 5.2 라플라시안 행렬
```python
# 비정규화 라플라시안
L = D - A

# 정규화 라플라시안 (대칭)
L_sym = D^(-1/2) × L × D^(-1/2)

# 정규화 라플라시안 (비대칭)
L_rw = D^(-1) × L

여기서:
- D: 차수 행렬 (대각선에 각 노드의 차수)
- A: 인접 행렬
```

### 5.3 스펙트럴 클러스터링 알고리즘
```python
def spectral_clustering(G, k):
    1. 라플라시안 행렬 L 계산
    2. L의 가장 작은 k개 고유값에 대응하는 고유벡터 계산
    3. 고유벡터들을 열로 하는 행렬 U 구성
    4. U의 각 행을 k차원 공간의 점으로 간주
    5. k-평균 등으로 클러스터링 수행
```

## 6. 그래프 클러스터링 평가 지표

### 6.1 내부 평가 지표

#### 모듈성 (Modularity)
```python
Q = (1/2m) Σ[A_ij - (k_i × k_j)/(2m)] × δ(c_i, c_j)
```

#### 전도성 (Conductance)
```python
φ(S) = cut(S, S̄) / min(vol(S), vol(S̄))

여기서:
- cut(S, S̄): S와 S̄ 사이의 엣지 수
- vol(S): S 내 노드들의 차수 합
```

#### 클러스터링 계수 (Clustering Coefficient)
```python
C_i = (2 × 삼각형 수) / (k_i × (k_i - 1))
```

### 6.2 외부 평가 지표

#### 정규화 상호 정보량 (NMI)
```python
NMI(X,Y) = 2 × I(X;Y) / (H(X) + H(Y))
```

#### 조정 랜드 지수 (ARI)
```python
ARI = (RI - E[RI]) / (max(RI) - E[RI])
```

## 7. 그래프 클러스터링의 장단점

### 7.1 장점
1. **구조 정보 활용**
   - 노드 간 관계 정보 직접 활용
   - 네트워크 토폴로지 반영

2. **다양한 데이터 적용**
   - 소셜 네트워크, 생물학적 네트워크
   - 추천 시스템, 웹 분석

3. **계층적 구조 탐지**
   - 다층 커뮤니티 구조 발견
   - 스케일에 따른 다른 관점 제공

4. **해석 가능성**
   - 커뮤니티의 의미가 직관적
   - 네트워크 분석과 연계 가능

### 7.2 단점
1. **계산 복잡도**
   - 대규모 그래프에서 비효율적
   - 일부 알고리즘은 O(n³) 복잡도

2. **파라미터 선택**
   - 클러스터 개수 결정 어려움
   - 해상도 파라미터 조정 필요

3. **그래프 구성**
   - 적절한 그래프 표현 방법 선택
   - 엣지 가중치 설정 문제

4. **노이즈 민감도**
   - 잘못된 엣지에 민감
   - 희소한 그래프에서 성능 저하

## 8. 실제 적용 사례

### 8.1 소셜 네트워크 분석
- **커뮤니티 탐지**: 친구 그룹, 관심사 그룹
- **영향력 분석**: 정보 전파 경로 분석
- **추천 시스템**: 유사한 사용자 그룹 기반 추천

### 8.2 생물정보학
- **단백질 상호작용**: 기능적 모듈 탐지
- **유전자 네트워크**: 공동 발현 그룹 분석
- **대사 경로**: 생화학적 경로 분석

### 8.3 웹 분석
- **웹페이지 클러스터링**: 주제별 페이지 그룹화
- **링크 분석**: 관련 사이트 탐지
- **검색 결과 클러스터링**: 검색 결과 조직화

### 8.4 교통 네트워크
- **도로 네트워크**: 교통 흐름 패턴 분석
- **대중교통**: 노선 최적화
- **물류 네트워크**: 배송 경로 최적화

## 9. 고급 주제

### 9.1 동적 그래프 클러스터링
- **시간 변화**: 시간에 따른 커뮤니티 변화 추적
- **온라인 알고리즘**: 실시간 커뮤니티 업데이트
- **안정성 분석**: 커뮤니티 구조의 지속성 평가

### 9.2 다층 네트워크
- **멀티플렉스**: 여러 유형의 관계 동시 고려
- **다층 모듈성**: 층간 연결을 고려한 모듈성
- **층간 클러스터링**: 서로 다른 층의 정보 통합

### 9.3 중첩 커뮤니티
- **중첩 구조**: 하나의 노드가 여러 커뮤니티에 속함
- **퍼지 클러스터링**: 소속 확률 기반 클러스터링
- **계층적 중첩**: 다층 중첩 구조 탐지

## 10. 구현 시 고려사항

### 10.1 그래프 표현
```python
# NetworkX 사용 예시
import networkx as nx

# 그래프 생성
G = nx.Graph()
G.add_edges_from([(1,2), (2,3), (3,4)])

# 가중치 그래프
G.add_weighted_edges_from([(1,2,0.5), (2,3,0.8)])
```

### 10.2 메모리 최적화
- **희소 행렬**: scipy.sparse 활용
- **스트리밍**: 대용량 그래프 배치 처리
- **근사 알고리즘**: 정확도와 효율성 트레이드오프

### 10.3 병렬 처리
- **분산 처리**: 그래프 분할 후 병렬 처리
- **GPU 가속**: CUDA 기반 그래프 알고리즘
- **멀티스레딩**: 독립적 연산의 병렬화

## 요약

그래프 기반 클러스터링은 네트워크 구조를 가진 데이터에서 커뮤니티를 탐지하는 강력한 방법입니다:

1. **핵심 개념**: 그래프 이론 기반의 클러스터링
2. **주요 알고리즘**: Louvain, Girvan-Newman, Label Propagation
3. **평가 지표**: 모듈성, 전도성, NMI, ARI
4. **적용 분야**: 소셜 네트워크, 생물정보학, 웹 분석

적절한 그래프 표현과 알고리즘 선택을 통해 네트워크 데이터에서 의미 있는 커뮤니티 구조를 발견할 수 있습니다.